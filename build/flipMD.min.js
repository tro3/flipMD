/*
/* flipMD - Markdown components for Flip
*/
(function(){angular.module("flipMD",["flipMD.marked"])}).call(this),function(){angular.module("flipMD",["flipMD.marked","flipMD.mdEdit"])}.call(this),function(){"use strict";angular.module("flipMD.marked",[]).provider("marked",function(){var a=this;a.setOptions=function(a){this.defaults=a},a.$get=["$window",function(b){var c=b.marked;return a.setOptions=c.setOptions,c.setOptions(a.defaults),c}]}).directive("marked",["marked",function(a){return{restrict:"AE",replace:!0,scope:{opts:"=",marked:"="},link:function(b,c,d){function e(d){c.html(a(d||"",b.opts||null))}e(b.marked||c.text()||""),d.marked&&b.$watch("marked",e)}}}])}(),function(){angular.module("flipMD.mdEdit",["ui.bootstrap"]).directive("mdEdit",function(){return{scope:{md:"=ngModel"},controller:"mdEditCtrl",templateUrl:"mdEdit/mdEdit.html",link:function(a,b){return a.textArea=b.find("textarea")[0]}}}).controller("mdEditCtrl",["$scope","$timeout",function(a,b){var c;return c=a,c.preview=!1,c.hasSelection=function(){return c.textArea.selectionStart===c.textArea.textLength?!1:!0},c.getSelection=function(){return{start:c.textArea.selectionStart,end:c.textArea.selectionEnd,text:c.textArea.value.substring(c.textArea.selectionStart,c.textArea.selectionEnd)}},c.setSelection=function(a,b){return c.textArea.focus(),c.textArea.selectionStart=a,c.textArea.selectionEnd=a+b},c.insertPlaceholder=function(a,d,e){var f,g;return f=c.md.length+d,c.md+=a,g=a.length-d-e,b(function(){return c.setSelection(f,g)})},c.insertTextOld=function(a,b,d){var e,f;return e=c.md.substring(0,b),f=c.md.substring(d),c.md=e+a+f,c.textArea.focus()},c.insertText=function(a,d,e,f,g){var h,i;return h=c.md.substring(0,d),i=c.md.substring(e),c.md=h+a+i,b(function(){return c.setSelection(d+f,a.length-f-g)})},c.onPreview=function(){return c.preview=!c.preview,console.log(c.preview)},c.onEditor=function(a){var b,d,e;switch(b=c.getSelection(),a){case"bold":return e=b.text.length?b.text:"bold",c.insertText("**"+e+"**",b.start,b.end,2,2);case"italic":return e=b.text.length?b.text:"italic",c.insertText("_"+e+"_",b.start,b.end,1,1);case"underline":return e=b.text.length?b.text:"underline",c.insertText("<u>"+e+"</u>",b.start,b.end,3,4);case"list":return c.insertText("\n- Item",c.md.length,c.md.length,3,0);case"list-2":return c.insertText("\n1. Item",c.md.length,c.md.length,4,0);case"table":return d="\n\n| Column1 | Column2 | Column3 |\n| ------- |:-------:| -------:|\n| Row1    | Data    | More    |\n| Row2    | Data    | More    |",c.insertText(d,c.md.length,c.md.length,d.length,0);case"header":return c.insertText("\n\n# Header\n\n",b.end,b.end,4,2);case"url":return c.insertText("[link text](url)",b.end,b.end,12,1);case"img":return c.insertText("![alt text](url)",b.end,b.end,12,1);case"code":return b.text.length?c.insertText("`"+b.text+"`",b.start,b.end,1,1):c.insertText("\n```\ncode here\n```",c.md.length,c.md.length,5,3);case"hline":return c.insertText("\n\n---\n\n",b.end,b.end,7,0);case"quote":return c.hasSelection()?c.insertTextOld("> "+b.text,b.start,b.end):c.insertPlaceholder("> quote",2,0);case"strikethrough":return e=b.text.length?b.text:"strikethrough",c.insertText("~~"+e+"~~",b.start,b.end,2,2)}}}]).run(["$templateCache",function(a){return a.put("mdEdit/mdEdit.html",'<div class="panel panel-default">\n  <div class="panel-heading clearfix">\n    <div class="pull-left" ng-show="!preview">\n      <button class="btn btn-default btn-xs fa fa-bold"          ng-click="onEditor(\'bold\')"          tooltip="Bold"></button>\n      <button class="btn btn-default btn-xs fa fa-italic"        ng-click="onEditor(\'italic\')"        tooltip="Italic"></button>\n      <button class="btn btn-default btn-xs fa fa-underline"     ng-click="onEditor(\'underline\')"     tooltip="Underline"></button>\n      <button class="btn btn-default btn-xs fa fa-minus"         ng-click="onEditor(\'hline\')"         tooltip="Horizontal Line"></button>\n      <button class="btn btn-default btn-xs fa fa-list-ul"       ng-click="onEditor(\'list\')"          tooltip="Bullet List"></button>\n      <button class="btn btn-default btn-xs fa fa-list-ol"       ng-click="onEditor(\'list-2\')"        tooltip="Numbered List"></button>\n      <button class="btn btn-default btn-xs fa fa-table"         ng-click="onEditor(\'table\')"         tooltip="Table"></button>\n      <button class="btn btn-default btn-xs fa fa-header"        ng-click="onEditor(\'header\')"        tooltip="Header"></button>\n      <button class="btn btn-default btn-xs fa fa-paperclip"     ng-click="onEditor(\'url\')"           tooltip="Link"></button>\n      <button class="btn btn-default btn-xs fa fa-image"         ng-click="onEditor(\'img\')"           tooltip="Image"></button>\n      <button class="btn btn-default btn-xs fa fa-code"          ng-click="onEditor(\'code\')"          tooltip="Code"></button>\n      <button class="btn btn-default btn-xs fa fa-quote-left"    ng-click="onEditor(\'quote\')"         tooltip="Quote"></button>\n      <button class="btn btn-default btn-xs fa fa-strikethrough" ng-click="onEditor(\'strikethrough\')" tooltip="Strikethrough"></button>\n    </div>\n    <div class="pull-right">\n      <button class="btn btn-default btn-xs fa fa-eye" ng-click="onPreview()" ng-class="{active: preview}" tooltip="Preview"></button>\n      <a class="btn btn-default btn-xs fa fa-question" href="https://help.github.com/articles/markdown-basics/" tooltip="Help"></a>\n    </div>\n  </div>\n  <div class="panel-body" style="padding: 2px;" ng-show="!preview">\n    <textarea id="mdEditArea" class="form-control" rows="20" style="font-family: \'Andale Mono\', \'Lucida Typewriter\', monospace; font-size: small" ng-model="md" ng-trim="false"></textarea>\n  </div>\n  <div class="panel-body" ng-show="preview">\n    <div marked="md"></div>\n  </div>\n</div>')}])}.call(this);