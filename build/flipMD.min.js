/*
/* flipMD - Markdown components for Flip
*/
(function(){angular.module("flipMD",["flipMD.marked"])}).call(this),function(){angular.module("flipMD",["flipMD.marked"])}.call(this),function(){"use strict";angular.module("flipMD.marked",[]).provider("marked",function(){var a=this;a.setOptions=function(a){this.defaults=a},a.$get=["$window",function(b){var c=b.marked;return a.setOptions=c.setOptions,c.setOptions(a.defaults),c}]}).directive("marked",["marked",function(a){return{restrict:"AE",replace:!0,scope:{opts:"=",marked:"="},link:function(b,c,d){function e(d){c.html(a(d||"",b.opts||null))}e(b.marked||c.text()||""),d.marked&&b.$watch("marked",e)}}}])}(),function(){angular.module("flipMD.mdEdit",[]).directive("mdEdit",function(){return{scope:{md:"=ngModel"},controller:"mdEditCtrl",templateUrl:"mdEdit/mdEdit.html",link:function(a,b){return a.textArea=b.find("textarea")[0]}}}).controller("mdEditCtrl",["$scope","$timeout",function(a,b){var c;return c=a,c.preview=!1,c.hasSelection=function(){return c.textArea.selectionStart===c.textArea.textLength?!1:!0},c.getSelection=function(){return{start:c.textArea.selectionStart,end:c.textArea.selectionEnd,text:c.textArea.value.substring(c.textArea.selectionStart,c.textArea.selectionEnd)}},c.setSelection=function(a,b){return c.textArea.focus(),c.textArea.selectionStart=a,c.textArea.selectionEnd=a+b},c.insertPlaceholder=function(a,d,e){var f,g;return f=c.md.length+d,c.md+=a,g=a.length-d-e,b(function(){return c.setSelection(f,g)})},c.insertTextOld=function(a,b,d){var e,f;return e=c.md.substring(0,b),f=c.md.substring(d),c.md=e+a+f,c.textArea.focus()},c.insertText=function(a,d,e,f,g){var h,i;return h=c.md.substring(0,d),i=c.md.substring(e),c.md=h+a+i,b(function(){return c.setSelection(d+f,a.length-f-g)})},c.onPreview=function(){return c.preview=!c.preview,console.log(c.preview)},c.onEditor=function(a){var b,d,e,f;switch(e=c.getSelection(),a){case"bold":return f=e.text.length?e.text:"bold",c.insertText("**"+f+"**",e.start,e.end,2,2);case"italic":return f=e.text.length?e.text:"italic",c.insertText("_"+f+"_",e.start,e.end,1,1);case"underline":return f=e.text.length?e.text:"underline",c.insertText("<u>"+f+"</u>",e.start,e.end,3,4);case"list":return c.insertText("\n- Item",c.md.length,c.md.length,3,0);case"list-2":return c.insertText("\n1. Item",c.md.length,c.md.length,4,0);case"header":return c.insertText("\n\n# Header\n\n",e.end,e.end,4,2);case"url":return d=prompt("Enter URL here:"),""===d&&(d="http://codedaily.vn"),c.md+="\n",b="[text]("+d+")",c.insertPlaceholder(b,1,d.length+3);case"img":return d=prompt("Enter image URL here:"),""===d&&(d="http://codedaily.vn"),c.md+="\n",b="![image text]("+d+")",c.insertPlaceholder(b,2,d.length+3);case"code":return e.text.length?c.insertText("`"+e.text+"`",e.start,e.end,1,1):c.insertText("\n```\ncode here\n```",c.md.length,c.md.length,5,3);case"hline":return c.insertText("\n\n---\n\n",e.end,e.end,7,0);case"quote":return c.hasSelection()?c.insertTextOld("> "+e.text,e.start,e.end):c.insertPlaceholder("> quote",2,0);case"strikethrough":return f=e.text.length?e.text:"strikethrough",c.insertText("~~"+f+"~~",e.start,e.end,2,2)}}}]).run(["$templateCache",function(a){return a.put("mdEdit/mdEdit.html",'<div class="panel panel-default">\n  <div class="panel-heading clearfix">\n    <div class="pull-left" ng-show="!preview">\n      <button class="btn btn-default btn-xs fa fa-bold" ng-click="onEditor(\'bold\')"></button>\n      <button class="btn btn-default btn-xs fa fa-italic" ng-click="onEditor(\'italic\')"></button>\n      <button class="btn btn-default btn-xs fa fa-underline" ng-click="onEditor(\'underline\')"></button>\n      <button class="btn btn-default btn-xs fa fa-minus" ng-click="onEditor(\'hline\')"></button>\n      <button class="btn btn-default btn-xs fa fa-list-ul" ng-click="onEditor(\'list\')"></button>\n      <button class="btn btn-default btn-xs fa fa-list-ol" ng-click="onEditor(\'list-2\')"></button>\n      <button class="btn btn-default btn-xs fa fa-header" ng-click="onEditor(\'header\')"></button>\n      <button class="btn btn-default btn-xs fa fa-paperclip" ng-click="onEditor(\'url\')"></button>\n      <button class="btn btn-default btn-xs fa fa-image" ng-click="onEditor(\'img\')"></button>\n      <button class="btn btn-default btn-xs fa fa-code" ng-click="onEditor(\'code\')"></button>\n      <button class="btn btn-default btn-xs fa fa-quote-left" ng-click="onEditor(\'quote\')"></button>\n      <button class="btn btn-default btn-xs fa fa-strikethrough" ng-click="onEditor(\'strikethrough\')"></button>\n    </div>\n    <div class="pull-right">\n      <button class="btn btn-default btn-xs fa fa-eye" ng-click="onPreview()" ng-class="{active: preview}"></button>\n    </div>\n  </div>\n  <div class="panel-body" style="padding: 2px;" ng-show="!preview">\n    <textarea id="mdEditArea" class="form-control" rows="20" style="font-family: \'Andale Mono\', \'Lucida Typewriter\', monospace; font-size: small" ng-model="md" ng-trim="false"></textarea>\n  </div>\n  <div class="panel-body" ng-show="preview">\n    <div marked="md"></div>\n  </div>\n</div>')}])}.call(this);